!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e=n();for(var r in e)("object"==typeof exports?exports:t)[r]=e[r]}}(this,function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){"use strict";e.r(n),e.d(n,"__extends",function(){return o}),e.d(n,"__assign",function(){return i}),e.d(n,"__rest",function(){return a}),e.d(n,"__decorate",function(){return s}),e.d(n,"__param",function(){return u}),e.d(n,"__metadata",function(){return c}),e.d(n,"__awaiter",function(){return f}),e.d(n,"__generator",function(){return h}),e.d(n,"__exportStar",function(){return l}),e.d(n,"__values",function(){return p}),e.d(n,"__read",function(){return d}),e.d(n,"__spread",function(){return y}),e.d(n,"__await",function(){return _}),e.d(n,"__asyncGenerator",function(){return v}),e.d(n,"__asyncDelegator",function(){return b}),e.d(n,"__asyncValues",function(){return g}),e.d(n,"__makeTemplateObject",function(){return w}),e.d(n,"__importStar",function(){return m}),e.d(n,"__importDefault",function(){return S});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function o(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var i=function(){return(i=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function a(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&(e[r[o]]=t[r[o]])}return e}function s(t,n,e,r){var o,i=arguments.length,a=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,n,e,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(n,e,a):o(n,e))||a);return i>3&&a&&Object.defineProperty(n,e,a),a}function u(t,n){return function(e,r){n(e,r,t)}}function c(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)}function f(t,n,e,r){return new(e||(e=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new e(function(n){n(t.value)}).then(a,s)}u((r=r.apply(t,n||[])).next())})}function h(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function l(t,n){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}function p(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}function d(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(d(arguments[n]));return t}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function v(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=e.apply(t,n||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){o[t]&&(r[t]=function(n){return new Promise(function(e,r){i.push([t,n,e,r])>1||s(t,n)})})}function s(t,n){try{(e=o[t](n)).value instanceof _?Promise.resolve(e.value.v).then(u,c):f(i[0][2],e)}catch(t){f(i[0][3],t)}var e}function u(t){s("next",t)}function c(t){s("throw",t)}function f(t,n){t(n),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(t){var n,e;return n={},r("next"),r("throw",function(t){throw t}),r("return"),n[Symbol.iterator]=function(){return this},n;function r(r,o){n[r]=t[r]?function(n){return(e=!e)?{value:_(t[r](n)),done:"return"===r}:o?o(n):n}:o}}function g(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=p(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise(function(r,o){(function(t,n,e,r){Promise.resolve(r).then(function(n){t({value:n,done:e})},n)})(r,o,(n=t[e](n)).done,n.value)})}}}function w(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t}function m(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}function S(t){return t&&t.__esModule?t:{default:t}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0).__importDefault(e(2));n.StateMachineControl=r.default,n.default=r.default},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),o=e(3),i=e(4),a=function(){function t(t){this.options=t,this.onStateMap=new Map,this.onceStateMap=new Map,this.isPending=!1,this._onTransition={"*":function(){}},this.transitionCore=new o.TransitionCore(t.transitions,t.initState),this._onTransition=this.options.onTransition||this._onTransition,this.step=this.step.bind(this),this.on=this.on.bind(this)}return t.prototype.on=function(t,n){return!!~this.transitionCore.getStates().indexOf(t)&&(this.onStateMap.has(t)?this.onStateMap.get(t).push(n):this.onStateMap.set(t,[n]),!0)},t.prototype.once=function(t,n){return!!~this.transitionCore.getStates().indexOf(t)&&(this.onceStateMap.has(t)?this.onceStateMap.get(t).push(n):this.onceStateMap.set(t,[n]),!0)},t.prototype.off=function(t,n){var e=this.onStateMap.get(t),r=this.onceStateMap.get(t);e&&~e.indexOf(n)&&e.splice(e.indexOf(n),1),r&&~r.indexOf(n)&&r.splice(r.indexOf(n),1)},t.prototype.removeAllListener=function(t){t?(this.onStateMap.delete(t),this.onceStateMap.delete(t)):(this.onStateMap.clear(),this.onceStateMap.clear())},t.prototype.getMethods=function(t){return this.transitionCore.getMethods(t)},t.prototype.getStateList=function(){return this.transitionCore.getStates()},t.prototype.getState=function(){return this.transitionCore.state},t.prototype.step=function(t){for(var n,e,o=this,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];if(!0===this.isPending)return console.warn("Transition still working"),!1;try{this.isPending=!0,e=(n=this.transitionCore).stepTo.apply(n,[t].concat(i))}catch(t){throw this.isPending=!1,t}if(e instanceof Promise)return r.__awaiter(o,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,e];case 1:return!1===(t=r.sent())?[3,3]:[4,this.execTransition(t)];case 2:r.sent(),this.runHookFunction(t.on,i),this.isPending=!1,r.label=3;case 3:return[3,5];case 4:throw n=r.sent(),this.isPending=!1,n;case 5:return[2,t]}})});if(e){var s;try{s=this.execTransition(e)}catch(t){throw this.isPending=!1,t}return s instanceof Promise?r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,s];case 1:return t.sent(),[4,this.runHookFunction(e.on,i)];case 2:return t.sent(),this.isPending=!1,[2,e]}})}).catch(function(t){throw o.isPending=!1,t}):(this.runHookFunction(e.on,i),this.isPending=!1,e)}return this.isPending=!1,e},t.prototype.execTransition=function(t){var n,e=this;if("function"==typeof this._onTransition)n=this._onTransition(t);else{var o=this._onTransition["*"]&&this._onTransition["*"](t),a=this._onTransition[t.on]&&this._onTransition[t.on](t);n=!i.fnsHasPromise(o,a)||r.__awaiter(e,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,o];case 1:return t.sent(),[4,a];case 2:return t.sent(),[2]}})})}return n},t.prototype.runHookFunction=function(t,n){var e=this.onStateMap.get(t),r=this.onceStateMap.get(t);if(e&&e.forEach(function(t){return t.apply(void 0,n)}),r)for(;r.length;)r.shift().apply(void 0,n)},t.prototype.can=function(t){return!!~this.transitionCore.getMethods().indexOf(t)},t}();n.default=a},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),o=function(){function t(t,n){var e=this;this.transitionGroups=t,this.initState=n,this.transitionMap=new Map,this.stateList=new Set,this.transitionMethods=new Map,this._state=null,this._state=n,this.transitionGroups.forEach(function(t){var n=t.from+"/"+t.action;if(e.transitionMap.has(n))throw new Error("From "+t.from+" to "+("function"==typeof t.to?t.to():t.to)+" with "+t.action+" has repeated declarative");e.transitionMap.set(t.from+"/"+t.action,Object.freeze(t)),!e.stateList.has(t.from)&&"*"!==t.from&&e.stateList.add(t.from),e.transitionMethods.has(t.from)?e.transitionMethods.get(t.from).push(t.action):e.transitionMethods.set(t.from,[t.action]),"string"==typeof t.to&&!e.stateList.has(t.to)&&e.stateList.add(t.to)}),this.stepTo=this.stepTo.bind(this),this.getMethods=this.getMethods.bind(this),this.getStates=this.getStates.bind(this),this.stateOnTransition=this.stateOnTransition.bind(this)}return t.prototype.stepTo=function(t){for(var n=this,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var i=this._state,a=this._state+"/"+t;if(this.transitionMap.has("*/"+t))a="*/"+t;else if(!this.transitionMap.has(a))return console.warn("Cannot transition with "+t),!1;var s=Object.assign({},this.transitionMap.get(a)),u=!s.guardian||s.guardian.apply(s,e);return u instanceof Promise?r.__awaiter(n,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,u];case 1:return t=n.sent(),s.from=i,t?[4,this.stateOnTransition.apply(this,[s].concat(e))]:[3,3];case 2:return[2,n.sent()];case 3:return[2,!1]}})}):!!u&&(s.from=i,this.stateOnTransition.apply(this,[s].concat(e)))},t.prototype.getMethods=function(t){return void 0===t&&(t=this._state),this.transitionMethods.get(t)},t.prototype.getStates=function(){var t=[];return this.stateList.forEach(function(n){return t.push(n)}),t},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.stateOnTransition=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r="function"==typeof t.to?t.to.apply(t,n):t.to;return!!this.stateList.has(r)&&(this._state=r,{before:t.from,on:this._state,action:t.action,arg:n})},t}();n.TransitionCore=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fnsHasPromise=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some(function(t){return t instanceof Promise})}}])});